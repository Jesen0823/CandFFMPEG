https://www.bilibili.com/video/av246031229/

æŠ½å–aac:
ffmpeg -i jina.flv -acodec copy -vn jina.aac
è½¬æ¢æ ¼å¼ï¼š
ffmpeg -i jina.flv -vcodec copy -f mp4 jina.mp4

æŠ½å–h64:
ffmpeg -i jina.flv -an -vcodec copy jina.h264

è£å‡å°ºå¯¸ï¼š
ffmpeg -i jina.flv -vf crop=in_w-520:in_h-230 -c:v libx264 -c:a copy jina_520_230.mp4

æˆªå–ï¼š
ffmpeg -i jina.flv -ss 00:00:10 -t 10 jina_10.ts

æ‹¼æ¥ï¼štxtæ˜¯æ–‡ä»¶åˆ—è¡¨ï¼ˆæ ¼å¼ï¼šfile:filename,å¦‚ï¼šffmpeg -f concat -i concat_demo.txt concat_demo.mp4ï¼‰
ffmpeg -f concat -i inputs.txt out.flv

è§†é¢‘è½¬å›¾åƒï¼š
ffmpeg -i in.flv -r 1 -f image2 image-%3d.jepg

å›¾ç‰‡è½¬è§†é¢‘ï¼š
ffmpeg -i image-%3d.jepg out.mp4

ç›´æ’­æ¨æµ
ffmpeg -re -i out.mp4 -c copy -f flv rtmp://server/live/streamName

æ‹‰æµï¼š
ffmpeg -i rtmp://server/live/streamName -c copy dump.flv

ffmpeg -i rtmp://ns8.indexforce.com/home/mystream -c copy dump.flv

ffmpeg -i rtmp://58.200.131.2:1935/livetv/cctv6 -c copy tv6_lfs.flv



æ‰§è¡Œcå‘½ä»¤
clang -g -o test_log test_log.c -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil
æˆ–è€…ï¼š
clang -g -o test_log test_log.c `pkg-config --cflags  --libs libavutil`
./test_log
ldd test_log
å¦‚æœç¯å¢ƒå˜é‡ä¸å¯¹è¦é…ç½®ç¯å¢ƒå˜é‡
sudo vim ~/.bashrc
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/ffmpeg/lib/pkgconfig/
source ~/.bashrc

æ–‡ä»¶æ“ä½œï¼š
avpriv_io_detele
avpriv_io_move

ç›®å½•æ“ä½œï¼š
avio_open_dir()
avio_read_dir()
avio_close_dir()

ç»“æ„ä½“ï¼š
AVIODirContext æ“ä½œç›®å½•ä¸Šä¸‹æ–‡
AVIODirEntry ç›®å½•é¡¹ï¼Œæ–‡ä»¶åæ–‡ä»¶å¤§å°ç­‰ä¿¡æ¯

clang -g -o list ffmpeg_list.c `pkg-config --cflags --libs libavformat libavutil`

æ‰“å°mediainfoä¿¡æ¯ï¼šmdeiaInfo.c:
clang -g -o mediaInfo mdeiaInfo.c `pkg-config --cflags --libs libavutil libavformat`

é¡ºåºï¼š
ç¼–è¯‘è‡ªå·±çš„ç¨‹åºï¼Œé“¾æ¥åº“çš„é¡ºåºä¸º  -lavcodec -lavdevice -lavfilter -lavformat -lavutil -lpostproc -lswresample -lswscale -lx264 -lm -lrt -lz	
________________________________________________________________________________________________________________
$ locate libavutil.pc
/home/git/ffmpeg_moc/ffmpeg/libavutil/libavutil.pc
/usr/local/ffmpeg/lib/pkgconfig/libavutil.pc
/usr/local/ffmpeg/lib/libavcodec.so

/home/git/ffmpeg_moc/ffmpeg/android-build/pkgconfig/armeabi-v7a/libavcodec.pc
/home/git/ffmpeg_moc/ffmpeg/libavcodec/libavcodec.pc
/usr/lib/pkgconfig/libavcodec.pc
/usr/local/ffmpeg/lib/pkgconfig/libavcodec.pc
/usr/local/lib/pkgconfig/libavcodec.pc

120 export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/ffmpeg/lib/pkgconfig
121 export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/lib/pkgconfig
122 export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/lib/pkgconfig
123 export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/ffmpeg/lib/pkgconfig


job dir:
/home/git/ffmpeg_moc/videoroom/cproject/ch5

$ pkg-config --libs sdl2
-L/usr/local/lib -Wl,-rpath,/usr/local/lib -Wl,--enable-new-dtags -lSDL2
$ pkg-config --cflags --libs sdl2
-D_REENTRANT -I/usr/local/include/SDL2 -L/usr/local/lib -Wl,-rpath,/usr/local/lib -Wl,--enable-new-dtags -lSDL2
________________________________________________________________________________________________________________
clang -g -o player5 player5.c `pkg-config --cflags --libs sdl2` -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib /usr/local/ffmpeg/lib/libavutil -l avformat -l avcodec -lswresample -lswscale -lm -lrt -lz
./player4 dongman30.mp4

clang -g -o player5 player5.c `pkg-config --cflags --libs sdl2` -I/usr/local/include -L/usr/local/lib -l avutil -l avformat -l avcodec -lswresample -lswscale

clang -g -o player5 player5.c `pkg-config --cflags --libs sdl2` -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec -l swresample -l swscale


clang -g -o player2 player2.c `pkg-config --cflags --libs sdl2` -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec -l swresample -l swscale

______________________________________
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/home/git/ffmpeg_moc/libfdk_aac/lib/pkgconfig
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/usr/local/ffmpeg/lib/pkgconfig
export LD_LIBRARY_PATH=$LIB_LIBRARY_PATH:/home/git/ffmpeg_moc/libfdk_aac/lib
export LD_LIBRARY_PATH=$LIB_LIBRARY_PATH:/usr/local/ffmpeg/lib
export PKG_CONFIG=/usr/bin/pkg-config
export PATH=$PATH:/usr/local/ffmpeg/bin
export PATH=$PATH:/home/jesen/.local/bin

______________________________________

clang -g -o player2 player2.c `pkg-config --cflags --libs sdl2` -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec -l swscale

clang -g -o player2 player2.c `pkg-config --cflags --libs sdl2 libavutil libavformat libavcodec libswscale`

clang -g -o event_sdl event_sdl.c `pkg-config --cflags --libs sdl2`
/.event_sdl

clang -g -o first_sdl first_sdl.c `pkg-config --cflags --libs sdl2`
./first_sdl 

clang -g -o decode_video decode_video.c -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec -l swscale
 ./decode_video jina.mp4 ./outpic

clang -g -o encode_video encode_video.c -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec
./encode_video 1.h264 libx264
ffplay 1.h264                                              

clang -g -o extr_audio extr_audio.c -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec
./extr_audio jina.mp4 jina.aac 

clang -g -o remuxing remuxing.c -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec
clang -g -o remuxing remuxing.c `pkg-config --cflags --libs libavformat`
./remuxing jina.mp4 remuxing.flv

clang -g -o cutvideo cutvideo.c -I/usr/local/ffmpeg/include -L/usr/local/ffmpeg/lib -l avutil -l avformat -l avcodec
clang -g -o cutvideo cutvideo.c `pkg-config --libs libavutil libavformat libavcodec`
./cutvideo 5 10 jina.mp4 cutvideo.mp4

SDL_CreateThread() sdlä¸­åˆ›å»ºçº¿ç¨‹ï¼Œå‚æ•°ï¼š
fn :çº¿ç¨‹æ‰§è¡Œå‡½æ•°
name:çº¿ç¨‹å
data:æ‰§è¡Œå‡½æ•°å‚æ•°

SDLæ›´æ–°çº¹ç†ï¼š
SDL_UpdateTexture()
SDL_UpdateYUVTexture()æ•ˆç‡æ›´é«˜

ffmpeg -i dongman.mp4 dongman.yuv
ffplay -f rawvideo -video_size 1920x1080 -i dongman.yuv

1.mp4è½¬yuv
# ffmpeg -i guomei.mp4 guomei.yuv

2.æ’­æ”¾
# ffplay -f rawvideo -video_size 864x486 -i guomei.yuv
æ³¨æ„:å¿…é¡»æŒ‡å®šè½¬ç ä¹‹å‰åˆ†è¾¨ç‡åˆ†è¾¨ç‡:864x486

ï¼“.æŒ‰æ—¶é—´æˆªå–
å‰5ç§’å¸§è§†é¢‘
# ffmpeg -ss 00:00:00 -i guomei.mp4 -to 00:00:10 -c copy out05.mp4

æŠ½å–pcm:
$ ffmpeg -i dongman.mp4 -codec:a  pcm_f32le -ar 48000 -ac 2 -f f32le dongman.pcm
    -ar: æŒ‡å®šé‡‡æ ·ç‡;
    -ac: æŒ‡å®šå£°é“æ•°ï¼›
    -f f32le: è¡¨ç¤ºæ¯ä¸ªé‡‡æ ·ç‚¹ç”¨32ä½æµ®ç‚¹æ•°æ¥è¡¨ç¤ºï¼ˆleè¡¨ç¤ºå°ç«¯ï¼Œbeè¡¨ç¤ºå¤§ç«¯ï¼‰
æ’­æ”¾ï¼š
ffplay -ar 48000 -channels 2 -f f32le -i dongman.pcm

æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯ï¼š
ls -alt dongman.pcm
æ‰¹é‡ç§»åŠ¨MP4æ–‡ä»¶ï¼š
 sudo mv *.mp4 /home/jesen/videos/
é‡‡é›†éŸ³é¢‘ï¼š
ffmpeg -f alsa -i hw:0,0 xxx.wav

éŸ³è§†é¢‘åŒæ­¥æœ¬è´¨æ˜¯çº¿ç¨‹åŒæ­¥é—®é¢˜

é”çš„ç§ç±»ï¼š
è¯»å†™é”
è‡ªæ—‹é”ï¼šç­‰å¾…èµ„æºé‡Šæ”¾ï¼Œä¸€ç›´ç­‰
å¯é‡å…¥é”

SDLåˆ›å»ºçº¿ç¨‹ï¼š
SDL_CreateThread
SDL_WaitThread
SDL_CreateMutex/SDL_DestroyMutex äº’æ–¥é”
SDL_LockMutex/SDL_UnlockMutexé”ä½å˜é‡/é‡Šæ”¾
SDL_CreateCond/SDL_DestroyCondæ¡ä»¶å˜é‡
SDL_CondWait/SDL_CondSignalç­‰å¾…ï¼Œé‡Šæ”¾ä¿¡å·é‡ğŸš¥

è¡¥å……ï¼š
SDL_mutex äº’æ–¥é‡ï¼Œç”¨äºåŠ é”è§£é”
SDLâ€”â€”cond æ¡ä»¶å˜é‡ï¼Œç”¨äºå¤„ç†åŒæ­¥

æ’­æ”¾å™¨çº¿ç¨‹æ¨¡å‹ï¼š
ä¸»çº¿ç¨‹ï¼šå¤„ç†è¾“å…¥å‚æ•°ï¼Œçª—å£é”®ç›˜äº‹ä»¶ï¼Œè§†é¢‘æ¸²æŸ“
å­çº¿ç¨‹ï¼šå­çº¿ç¨‹1,è§£å¤ç”¨çº¿ç¨‹ï¼Œç»´æŠ¤è§†é¢‘æµé˜Ÿåˆ—å’ŒéŸ³é¢‘æµé˜Ÿåˆ—
        å­çº¿ç¨‹2, è§†é¢‘è§£ç çº¿ç¨‹ï¼Œæ”¾å…¥è§£ç è§†é¢‘é˜Ÿåˆ—ï¼Œç”±ä¸»çº¿ç¨‹å†è¾“å‡ºåˆ°è§†é¢‘æ˜¾å¡æ¸²æŸ“åˆ°å±å¹•
	å­çº¿ç¨‹3,æ‰“å¼€è§†é¢‘è®¾å¤‡çš„æ—¶å€™ï¼Œç”±sdlåˆ›å»ºéŸ³é¢‘æ¸²æŸ“çº¿ç¨‹ï¼ˆéŸ³é¢‘æµé˜Ÿåˆ—ä¸­çš„æ•°æ®æ¸²æŸ“åˆ°å£°å¡ï¼‰

éŸ³é¢‘è§†é¢‘æ¸²æŸ“ï¼Œç”±ä¸»çº¿ç¨‹é€šè¿‡TIMERå›è°ƒæ‹¿åˆ°è§†é¢‘å¸§å†æ¸²æŸ“å‡ºæ¥

éŸ³è§†é¢‘åŒæ­¥ï¼š
åˆ†3ç§ï¼š
1ï¼‰è§†é¢‘åŒæ­¥åˆ°éŸ³é¢‘ï¼ˆæ˜“ï¼‰
2ï¼‰éŸ³é¢‘åŒæ­¥åˆ°è§†é¢‘ï¼ˆéš¾ï¼‰
3ï¼‰éŸ³é¢‘è§†é¢‘åŒæ­¥åˆ°ç³»ç»Ÿæ—¶é’Ÿ
PTS:Presentation timestamp æ¸²æŸ“æ—¶é—´ 
DTSï¼šDecoding timestamp è§£ç æ—¶é—´

I/B/På¸§
AVPacket,AVFrameä¸­å¯ä»¥å–å¾—PTS, ä¸€èˆ¬å–è§£ç åçš„AVFrameä¸­çš„
av_frame_get_best_effort_timestamp()è·å–PTS

æ—¶é—´åŸº:
tbr:å¸§ç‡
tbn:time base of streamæµçš„æ—¶é—´åŸº
tbc:time base of codecè§£ç æ—¶é—´åŸº

è®¡ç®—å½“å‰å¸§çš„PTS:
PTS = PTS * av_q2d(video_stream->time_base)

è®¡ç®—ä¸‹ä¸€å¸§çš„PTS:
video_clock:é¢„æµ‹çš„ä¸‹ä¸€å¸§è§†é¢‘çš„PTS = frame_delay + PTS(ä¸Šä¸€å¸§çš„)
frame_delay:1/tbr
audio_clock:éŸ³é¢‘å½“å‰æ’­æ”¾çš„æ—¶é—´æˆ³


è§£å‹ï¼šsudo tar -xvJf Mojave-dark.tar.xz

ç»ˆç«¯é«˜é€¼æ ¼å±ä¿

sudo apt install cmatrix
cmatrix -b
_____________________________________________
JNIEnv javaçš„æœ¬åœ°åŒ–ç¯å¢ƒï¼Œç”¨æ¥è®¿é—®javaå¯¹è±¡
JavaVM ä¸€ä¸ªè¿›ç¨‹å¯¹åº”ä¸€ä¸ªJavaVM,ç”¨æ¥è·å–JNIEnv,ä¸€ä¸ªJavaVMæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹åº”ä¸€ä¸ªJNIEnv

c/c++è°ƒjavaæ–¹æ³•ï¼š
FindClass
GetMethodID/GetFieldID
NewObjectåˆ›å»ºjavaå¯¹è±¡
Call<TYPE>Method/[G/S]et<Type>Fieldè°ƒç”¨æ–¹æ³•
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
1.ç”Ÿæˆäº¤å‰ç¼–è¯‘å·¥å…·é“¾ï¼š
cd /home/jesen/Android/Sdk/ndk/22.1.7171670/build/tools

./make-standalone-toolchain.sh --toolchain=arm-linux-androideabi-4.9 --platform=android-19 --install-dir=../toolchain/ndk22

cd ../toolchain/ndk22ï¼Œå³ /home/jesen/Android/Sdk/ndk/22.1.7171670/build/toolchain/ndk22

cd bin/

ls æŸ¥çœ‹äº¤å‰ç¼–è¯‘æ‰€éœ€è¦çš„å·¥å…·

cd ../
cd include

ffmpegç›®å½•ï¼š/home/git/ffmpeg_moc/ffmpeg
æ·»åŠ androidç¼–è¯‘è„šæœ¬ build_ffmpeg_for_android.sh
æ‰§è¡Œ./
è¿›å…¥/home/git/ffmpeg_moc/ffmpeg/android-build/libs/armeabi-v7a
 æŸ¥çœ‹ç”Ÿæˆäº§ç‰©

2.ä¸ä½¿ç”¨ç¼–è¯‘å·¥å…·é“¾çš„æ–¹å¼ï¼š
ä¸‹è½½ android-ndk-r10e-linux-x86_64.zip è§£å‹ä¸ºandroid-ndk-r10e
cd android-ndk-r10e , /home/Android/android-ndk-r10e
 é…ç½®ç¯å¢ƒå˜é‡
#set android NDK environment
export ANDROID_NDK=/home/Android/android-ndk-r10e
export PATH=$PATH:$ANDROID_NDK
è¿›å…¥ /home/Android/android-ndk-r10e/platforms/android-19/arch-arm/usr
å¯ä»¥çœ‹åˆ°æ‰€æœ‰å·¥å…·

ffmpegç›®å½•ï¼š/home/git/ffmpeg_moc/ffmpeg
æ·»åŠ androidç¼–è¯‘è„šæœ¬ build_android.sh
æ‰§è¡Œ./build_android.shï¼Œå½“å‰ç›®å½•ä¸‹androidç›®å½•ä¼šç”Ÿæˆäº§ç‰©

å®é™…ç”Ÿæˆäº§ç‰©åœ¨ /usr/local/ffmpeg/lib

$ ./build_android.sh
/home/Android/ndk/android-ndk-r10e/toolchains/arm-linux-androideabi-4.9/prebuilt
/linux-x86_64/bin/arm-linux-androideabi-gcc is unable to create an executable file.
C compiler test failed.

If you think configure made a mistake, make sure you are using the latest
version from Git.  If the latest version fails, report the problem to the
ffmpeg-user@ffmpeg.org mailing list or IRC #ffmpeg on irc.freenode.net.
Include the log file "ffbuild/config.log" produced by configure as this will help
solve the problem.
Makefile:2: ffbuild/config.mak: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•
Makefile:40: /tools/Makefile: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•



--extra-cflags="-I/usr/local/include" \
 18 --extra-ldflags="-L/usr/local/lib" \
 19 --pkgconfigdir="/usr/local/lib/pkgconfig" \


sudo ./configure --disable-asm

sudo make

sudo make install
install -d /usr/local/bin
install x264 /usr/local/bin
install -d /usr/share/bash-completion/completions
install -m 644 ./tools/bash-autocomplete.sh /usr/share/bash-completion/completions/x264


Unable to create temporary directory in /xxx

FilteråŸç†ï¼š
å°†å‹ç¼©åçš„æ¯ä¸€å¸§æ•°æ®è§£ç ï¼Œè§£ç åçš„éŸ³è§†é¢‘æ•°æ®è®¡ç®—å¤„ç†ï¼Œå†æ¬¡è¿›è¡Œç¼–ç 
ffplay -i jina.mp4 -vf "drawbox=x=20:y=10:w=100:h=120:c=red"
ffplay -i jina.mp4 -vf "drawbox=20:10:100:120:red"

filterå‘½ä»¤è§„åˆ™ï¼š
å‚æ•°ä¹‹é—´  ï¼š
å¤šä¸ªfilterä¸²è”  ï¼Œ
å¤šä¸ªfilteræ²¡æœ‰å…³è” ï¼›

ffplay -i jina.mp4 -vf "movie=./ss.jepg,scale=64:64[wm];[in][wm]overlay=30:10"
[in]ä»£è¡¨æ¯ä¸€å¸§ï¼Œ[wm]ä»£è¡¨åˆ«åï¼Œ

ffplay -i jina.mp4 -vf "movie=./ss.jepg,scale=64:64[wm];[in][wm]overlay=30:10,drawbox=20:10:100:120:red"

APIæ–¹å¼ä½¿ç”¨filter:
è®¾ç½®filteræè¿°ç¬¦-> åˆå§‹åŒ–filter->æ»¤é•œå¤„ç†->é‡Šæ”¾filterèµ„æº

filteræè¿°ç¬¦ï¼š
ffplay -i jina.mp4 -vf "steps=0.5*PTS[v]" speed2.0.mp4
filterç›¸å…³ç»“æ„ä½“ï¼š
1.AVFilter:ä»£è¡¨ä¸€ä¸ªæ»¤é•œå®ä¾‹
{
	const char*name;
	const char*
}
2.AVFilterPadï¼šä¸€ä¸ªç«¯å£ï¼Œé€šè¿‡å®ƒå¯ä»¥çŸ¥é“filterçš„ç±»å‹è§†é¢‘/éŸ³é¢‘
{
 const char*name;
 enumAVMediaType type; // éŸ³é¢‘/è§†é¢‘
 ...
 
 int(*config_props)(AVFilterLink *link);

 int(*filter_frame)(AVFilterLink *link, AVFrame *frame); // è·å–è§†é¢‘
 
}
3.AVFilterLink:çº§è”æ—¶å€™é“¾æ¥ä¸¤ä¸ªfilterçš„æ¡¥æ¢
{
 AVFilterContext *src; // è¾“å‡º
 AVFilterContext *dst; // è¾“å…¥
 AVFilterPad *srcpad;
 AVFilterPad *dstpad;

 AVFilterFormats *in_formats;
 AVFilterFormats *out_formats;
}
4.AVFilterFormatï¼šå‰åfilteræ ¼å¼åå•†

Androi Logå‘½ä»¤ï¼š
adb logcat -v time > D:\\logcat.log
________________________________________________
